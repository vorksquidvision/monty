<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Monty Hall â€” Simulator</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
html,body{margin:0;padding:0;background:#0e0f13;color:#e8eaf1;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
.wrap{max-width:1100px;margin:14px auto;padding:10px}
.intro{text-align:center;margin-bottom:24px;padding:20px;background:#0f1320;border:1px solid #233055;border-radius:12px}
.intro h1{margin:0 0 12px;font-size:28px;color:#cfe0ff}
.intro p{margin:8px 0;font-size:16px;line-height:1.5}
.game-steps{display:flex;justify-content:center;gap:24px;margin:20px 0;flex-wrap:wrap}
.step{display:flex;flex-direction:column;align-items:center;gap:8px;min-width:120px}
.step-num{width:32px;height:32px;border-radius:50%;background:#1d8ffe;color:#fff;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:16px}
.step-content{text-align:center}
.doors{font-size:24px;margin-bottom:8px;letter-spacing:4px}
.step p{margin:0;font-size:14px;color:#9daccc}
.surprise{font-size:18px;margin-top:16px !important;color:#cfe0ff}
.highlight{color:#5ccfff;font-weight:700}
.row{display:flex;align-items:center;gap:10px;flex-wrap:wrap}
input[type=number]{width:140px;padding:6px 8px;background:#0f1320;color:#fff;border:1px solid #2a3350;border-radius:8px}
button{padding:8px 12px;border-radius:8px;border:0;background:#1d8ffe;color:#fff;font-weight:600;cursor:pointer}
button.secondary{background:#2a3350}
.stat{background:#0f1320;border:1px solid #233055;border-radius:10px;padding:8px 10px;margin-top:8px;display:grid;grid-template-columns:repeat(4,1fr);gap:8px}
.cell{text-align:center}
.lab{color:#9daccc;font-size:12px}
.val{font-weight:700}
.chart-wrap{position:relative;margin-top:10px}
canvas.chart{display:block;background:#0b0f1a;border:1px solid #1c2544;border-radius:12px;width:100%;height:auto;aspect-ratio:52/21}
canvas.chart.short{aspect-ratio:52/16}
.legend-panel{position:absolute;right:18px;top:18px;background:rgba(20,26,45,.9);border:1px solid #2a365f;padding:8px 10px;border-radius:10px;font-size:12px}
.key{display:flex;align-items:center;gap:8px;margin-top:6px}
.swatch{width:22px;height:3px;border-radius:2px;display:inline-block}
.small{color:#9daccc}
.tooltip{position:absolute;pointer-events:none;background:#151a2b;border:1px solid #2a3350;padding:8px 10px;border-radius:10px;box-shadow:0 8px 24px rgba(0,0,0,.35);font-size:12px;color:#e8eaf1;display:none;max-width:280px;z-index:3}
.tooltip .hd{font-weight:700;margin-bottom:4px}
@media (max-width:600px){
  .chart-wrap{
    display:flex;
    flex-direction:column;
  }
  .chart-wrap .legend-panel{
    position:static;
    order:-1;
    margin-bottom:8px;
    align-self:flex-start;
  }
  .lab{
    font-size:14px !important;
  }
  .val{
    font-size:16px !important;
  }
  .intro h1{
    font-size:24px !important;
  }
  .intro p{
    font-size:18px !important;
  }
  .step p{
    font-size:16px !important;
  }
  .surprise{
    font-size:20px !important;
  }
  .chart-wrap canvas{
    font-size:18px !important;
  }
}
</style>
</head>
<body>
<div class="wrap">
  <div class="intro">
  <h1>ğŸª The Monty Hall Problem</h1>
  <p>You're on a game show! There are 3 doors: behind one is a ğŸš— <strong>car</strong>, behind the others are ğŸ <strong>goats</strong>.</p>
  <div class="game-steps">
      <div class="step">
        <div class="step-num">1</div>
        <div class="step-content">
          <div class="doors">ğŸšª ğŸšª ğŸšª</div>
          <p>You pick a door</p>
        </div>
      </div>
      <div class="step">
        <div class="step-num">2</div>
        <div class="step-content">
          <div class="doors">ğŸšª âŒ ğŸšª</div>
          <p>Host opens a door with a goat</p>
        </div>
      </div>
      <div class="step">
        <div class="step-num">3</div>
        <div class="step-content">
          <div class="doors">ğŸšª â“ ğŸšª</div>
          <p><strong>Switch</strong> or <strong>stay</strong>?</p>
        </div>
      </div>
    </div>
    <p class="surprise">ğŸ¤¯ <strong>Surprise:</strong> Switching wins <span class="highlight">67%</span> of the time! Let's prove it...</p>
    <div style="margin:18px auto 0;max-width:600px;text-align:left;background:#151a2b;border-radius:10px;padding:16px 18px;border:1px solid #233055;color:#cfe0ff;font-size:16px;">
      <b>Why Switching Works</b>
      <ul style="margin:12px 0 0 18px;padding:0;list-style:square;">
        <li>When you pick a door, you have a <b>1/3 chance</b> of choosing the car ğŸš—, but the <b>other two doors together have a 2/3 chance</b> of hiding the car.</li>
        <li>The host, who knows whatâ€™s behind the doors, always opens another door to reveal a goat ğŸ.</li>
        <li>This action doesnâ€™t change the original odds: the <b>2/3 chance</b> that the car was elsewhere now rests entirely on the remaining unopened door.</li>
        <li>By switching, you take advantage of those odds and have a <b>2/3 chance</b> to win the car ğŸš—.</li>
      </ul>
      <div style="margin-top:16px;padding-top:12px;border-top:1px solid #233055;text-align:center;">
        <a href="cards.html" style="color:#5ccfff;text-decoration:none;font-weight:600;">ğŸƒ Try the Card Version â†’</a>
        <div style="font-size:14px;color:#9daccc;margin-top:4px;">See this principle with a 52-card deck (98% advantage!)</div>
      </div>
    </div>
  </div>
  
  <div class="row">
  <label for="iters">Iterations:</label>
  <input id="iters" type="number" min="10" max="1000000" step="10" value="1000">
  <button id="run">Run</button>
  <span class="small">Compare <b>Always Switch</b> vs <b>Always Stay</b>. Hover charts for details.</span>
  <span id="iterWarning" style="display:none;color:#ff7aa2;font-weight:600;margin-left:12px;"></span>
  </div>
  <div class="stat">
    <div class="cell"><div class="lab">Switch â€” Wins</div><div id="swWins" class="val">â€“</div></div>
    <div class="cell"><div class="lab">Switch â€” Win %</div><div id="swPct" class="val">â€“</div></div>
    <div class="cell"><div class="lab">Stay â€” Wins</div><div id="stWins" class="val">â€“</div></div>
    <div class="cell"><div class="lab">Stay â€” Win %</div><div id="stPct" class="val">â€“</div></div>
  </div>
  <div class="chart-wrap" id="wrap1">
    <canvas id="chart1" class="chart" width="1040" height="420" aria-label="Cumulative win% chart"></canvas>
    <div class="legend-panel">
      <div style="color:#cfe0ff;">Legend</div>
      <div class="key"><span class="swatch" style="background:#5ccfff"></span> Switch â€” Win %</div>
      <div class="key"><span class="swatch" style="background:#ff7aa2"></span> Stay â€” Win %</div>
      <div class="small">Dashes: 66.7% & 33.3%</div>
    </div>
    <div id="tooltip1" class="tooltip"></div>
  </div>
  <div class="chart-wrap" id="wrap2">
    <canvas id="chart2" class="chart short" width="1040" height="300" aria-label="Win Rate Race"></canvas>
    <div class="legend-panel">
      <div style="color:#cfe0ff;">Legend</div>
      <div class="key"><span class="swatch" style="background:#5ccfff"></span> Switch Wins</div>
      <div class="key"><span class="swatch" style="background:#ff7aa2"></span> Stay Wins</div>
      <div class="small">Dashed: theoretical rates</div>
    </div>
    <div id="tooltip2" class="tooltip"></div>
  </div>
</div>
<script>
var COLOR_SWITCH='#5ccfff';
var COLOR_STAY='#ff7aa2';
var COLOR_REF='#6ea9ff';
var COLOR_GRID='#22283a';
var COLOR_TEXT='#8e98ab';
var lastRun=null;
function generateScenarios(n){var list=new Array(n);for(var i=0;i<n;i++){var car=Math.floor(Math.random()*3);var first=Math.floor(Math.random()*3);var host=[0,1,2].filter(function(d){return d!==first&&d!==car});var opened=host[Math.floor(Math.random()*host.length)]||[0,1,2].filter(function(d){return d!==first})[0];list[i]={car:car,first:first,opened:opened}}return list}
function evalStrategy(scenarios,strategy){var n=scenarios.length,wins=0,series=new Array(n),outcomes=new Array(n);for(var i=0;i<n;i++){var s=scenarios[i];var pick=(strategy==='stay')?s.first:[0,1,2].filter(function(d){return d!==s.first&&d!==s.opened})[0];var win=(pick===s.car)?1:0;wins+=win;series[i]=100*wins/(i+1);outcomes[i]=win}return{wins:wins,series:series,outcomes:outcomes}}
function getCanvasMouse(canvas,evt){var rect=canvas.getBoundingClientRect();var scaleX=canvas.width/rect.width;var scaleY=canvas.height/rect.height;var c=evt.touches?evt.touches[0]:evt;return{x:(c.clientX-rect.left)*scaleX,y:(c.clientY-rect.top)*scaleY}}
function drawAxes(ctx,W,H,pL,pR,pT,pB,title,xlab,ylab){ctx.fillStyle=COLOR_TEXT;ctx.font='12px system-ui';ctx.textAlign='center';ctx.fillText(xlab,(W-pL-pR)/2+pL,H-8);ctx.save();ctx.translate(14,(H-pT-pB)/2+pT);ctx.rotate(-Math.PI/2);ctx.fillText(ylab,0,0);ctx.restore();var titleSize=window.innerWidth<=600?'18px':'14px';ctx.font=titleSize+' system-ui';ctx.fillStyle='#cfe0ff';ctx.fillText(title,(W-pL-pR)/2+pL,pT-12)}
function drawXTicks(ctx,N,pL,pR,pT,pB,W,H){if(N<=1)return;var inW=W-pL-pR;var desired=90;var maxTicks=Math.max(2,Math.floor(inW/desired));var step=Math.max(1,Math.round((N-1)/maxTicks));ctx.textAlign='center';ctx.textBaseline='top';ctx.strokeStyle=COLOR_GRID;ctx.lineWidth=1;ctx.fillStyle=COLOR_TEXT;ctx.font='12px system-ui';for(var i=0;i<N;i+=step){var x=pL+(i/(N-1))*inW;ctx.beginPath();ctx.moveTo(x,pT);ctx.lineTo(x,H-pB);ctx.stroke();ctx.fillText(String(i+1),x,H-pB+8)}}
function drawCumulative(canvas,swSeries,stSeries,hoverIndex){var ctx=canvas.getContext('2d');var W=canvas.width,H=canvas.height;ctx.clearRect(0,0,W,H);var pL=64,pR=18,pT=48,pB=42;var inW=W-pL-pR,inH=H-pT-pB;ctx.strokeStyle=COLOR_GRID;ctx.lineWidth=1;ctx.font='12px system-ui';ctx.fillStyle=COLOR_TEXT;ctx.textAlign='right';ctx.textBaseline='middle';for(var p=0;p<=100;p+=10){var y=pT+(1-p/100)*inH;ctx.beginPath();ctx.moveTo(pL,y);ctx.lineTo(W-pR,y);ctx.stroke();ctx.fillText(p+'%',pL-8,y)}drawXTicks(ctx,swSeries.length,pL,pR,pT,pB,W,H);function line(series,color){ctx.strokeStyle=color;ctx.lineWidth=2;ctx.beginPath();for(var i=0;i<series.length;i++){var x=pL+(i/(series.length-1))*inW;var y=pT+(1-series[i]/100)*inH;if(i===0)ctx.moveTo(x,y);else ctx.lineTo(x,y)}ctx.stroke()}line(swSeries,COLOR_SWITCH);line(stSeries,COLOR_STAY);ctx.setLineDash([6,6]);ctx.strokeStyle=COLOR_REF;[66.6667,33.3333].forEach(function(p){var y=pT+(1-p/100)*inH;ctx.beginPath();ctx.moveTo(pL,y);ctx.lineTo(W-pR,y);ctx.stroke()});ctx.setLineDash([]);if(hoverIndex!=null){var x=pL+(hoverIndex/(swSeries.length-1))*inW;ctx.strokeStyle='#cfe0ff88';ctx.lineWidth=1.2;ctx.beginPath();ctx.moveTo(x,pT);ctx.lineTo(x,H-pB);ctx.stroke();var y1=pT+(1-swSeries[hoverIndex]/100)*inH;var y2=pT+(1-stSeries[hoverIndex]/100)*inH;ctx.fillStyle=COLOR_SWITCH;ctx.beginPath();ctx.arc(x,y1,3,0,Math.PI*2);ctx.fill();ctx.fillStyle=COLOR_STAY;ctx.beginPath();ctx.arc(x,y2,3,0,Math.PI*2);ctx.fill()}drawAxes(ctx,W,H,pL,pR,pT,pB,'Cumulative Win %','Trials','Win %');return{pL:pL,pR:pR,pT:pT,pB:pB,inW:inW,inH:inH,N:swSeries.length}}
function drawRacingBars(canvas, swOut, stOut, hoverIndex){
  var ctx=canvas.getContext('2d');
  var W=canvas.width,H=canvas.height;
  ctx.clearRect(0,0,W,H);
  var pL=64,pR=18,pT=48,pB=42;
  var inW=W-pL-pR,inH=H-pT-pB;
  var N=swOut.length;
  
  if(N===0){
    drawAxes(ctx,W,H,pL,pR,pT,pB,'Trial by Trial Results','','');
    return{pL:pL,pR:pR,pT:pT,pB:pB,inW:inW,inH:inH,N:0};
  }
  
  // Calculate cumulative wins for each trial
  var swCumulative=[];
  var stCumulative=[];
  var swWins=0,stWins=0;
  
  for(var i=0;i<N;i++){
    if(swOut[i]) swWins++;
    if(stOut[i]) stWins++;
    swCumulative[i]=swWins;
    stCumulative[i]=stWins;
  }
  
  // Draw grid lines
  ctx.strokeStyle=COLOR_GRID;
  ctx.lineWidth=1;
  
  // Horizontal grid lines (wins)
  var maxWins=Math.max(swWins,stWins);
  var stepWins=Math.max(1,Math.ceil(maxWins/10));
  ctx.font='12px system-ui';
  ctx.fillStyle=COLOR_TEXT;
  ctx.textAlign='right';
  ctx.textBaseline='middle';
  
  for(var w=0;w<=maxWins;w+=stepWins){
    var y=pT+inH-(w/maxWins)*inH;
    ctx.beginPath();
    ctx.moveTo(pL,y);
    ctx.lineTo(W-pR,y);
    ctx.stroke();
    ctx.fillText(String(w),pL-8,y);
  }
  
  // Vertical grid lines (trials)
  drawXTicks(ctx,N,pL,pR,pT,pB,W,H);
  
  // Draw win accumulation lines
  function drawLine(cumulative,color){
    if(cumulative.length===0) return;
    ctx.strokeStyle=color;
    ctx.lineWidth=3;
    ctx.beginPath();
    
    for(var i=0;i<cumulative.length;i++){
      var x=pL+(i/(N-1))*inW;
      var y=pT+inH-(cumulative[i]/maxWins)*inH;
      if(i===0) ctx.moveTo(x,y);
      else ctx.lineTo(x,y);
    }
    ctx.stroke();
  }
  
  drawLine(swCumulative,COLOR_SWITCH);
  drawLine(stCumulative,COLOR_STAY);
  
  // Draw individual trial markers
  var dotSize=3;
  for(var i=0;i<N;i++){
    var x=pL+(i/(N-1))*inW;
    
    // Switch outcome
    var swY=pT+inH-(swCumulative[i]/maxWins)*inH;
    ctx.fillStyle=swOut[i]?COLOR_SWITCH:'#2a3350';
    ctx.beginPath();
    ctx.arc(x,swY,dotSize,0,Math.PI*2);
    ctx.fill();
    
    // Stay outcome  
    var stY=pT+inH-(stCumulative[i]/maxWins)*inH;
    ctx.fillStyle=stOut[i]?COLOR_STAY:'#2a3350';
    ctx.beginPath();
    ctx.arc(x,stY,dotSize,0,Math.PI*2);
    ctx.fill();
  }
  
  // Reference line for theoretical switch advantage
  if(N>10){
    var theoreticalSwitch=(N*2/3);
    var theoreticalStay=(N*1/3);
    
    ctx.setLineDash([6,6]);
    ctx.strokeStyle=COLOR_REF;
    ctx.lineWidth=1.5;
    
    // Theoretical switch line
    var swTheoY=pT+inH-(theoreticalSwitch/maxWins)*inH;
    if(swTheoY>=pT && swTheoY<=pT+inH){
      ctx.beginPath();
      ctx.moveTo(pL,swTheoY);
      ctx.lineTo(W-pR,swTheoY);
      ctx.stroke();
    }
    
    // Theoretical stay line  
    var stTheoY=pT+inH-(theoreticalStay/maxWins)*inH;
    if(stTheoY>=pT && stTheoY<=pT+inH){
      ctx.beginPath();
      ctx.moveTo(pL,stTheoY);
      ctx.lineTo(W-pR,stTheoY);
      ctx.stroke();
    }
    
    ctx.setLineDash([]);
  }
  
  // Hover indicator
  if(hoverIndex != null && hoverIndex < N){
    var x=pL+(hoverIndex/(N-1))*inW;
    ctx.strokeStyle='#cfe0ff88';
    ctx.lineWidth=2;
    ctx.beginPath();
    ctx.moveTo(x,pT);
    ctx.lineTo(x,pT+inH);
    ctx.stroke();
    
    // Highlight the specific trial outcomes
    var swY=pT+inH-(swCumulative[hoverIndex]/maxWins)*inH;
    var stY=pT+inH-(stCumulative[hoverIndex]/maxWins)*inH;
    
    ctx.fillStyle=COLOR_SWITCH;
    ctx.beginPath();
    ctx.arc(x,swY,5,0,Math.PI*2);
    ctx.fill();
    
    ctx.fillStyle=COLOR_STAY;
    ctx.beginPath();
    ctx.arc(x,stY,5,0,Math.PI*2);
    ctx.fill();
  }
  
  drawAxes(ctx,W,H,pL,pR,pT,pB,'Trial by Trial Results','Trials','Cumulative Wins');
  
  return{pL:pL,pR:pR,pT:pT,pB:pB,inW:inW,inH:inH,N:N,maxWins:maxWins};
}
function formatPct(x){return(Math.round(x*1000)/10).toFixed(1)+'%'}
function simulateAndRender(){
  var maxIter = 1000000;
  var inputElem = document.getElementById('iters');
  var warningElem = document.getElementById('iterWarning');
  var val = parseInt(inputElem.value || '1000', 10);
  var n = Math.max(10, Math.min(maxIter, val));
  if (val > maxIter) {
    warningElem.textContent = 'Maximum allowed is 1,000,000. Value has been capped.';
    warningElem.style.display = 'inline';
    inputElem.value = maxIter;
    n = maxIter;
  } else {
    warningElem.style.display = 'none';
  }
  var sc = generateScenarios(n);
  var sw = evalStrategy(sc, 'switch');
  var st = evalStrategy(sc, 'stay');
  lastRun = { scenarios: sc, sw: sw, st: st };
  document.getElementById('swWins').textContent = sw.wins.toLocaleString();
  document.getElementById('stWins').textContent = st.wins.toLocaleString();
  document.getElementById('swPct').textContent = formatPct(sw.wins / n);
  document.getElementById('stPct').textContent = formatPct(st.wins / n);
  drawCumulative(document.getElementById('chart1'), sw.series, st.series, null);
  drawRacingBars(document.getElementById('chart2'), sw.outcomes, st.outcomes, null);
}
function attachHover(wrapId,canvas,drawFn,tipId,getArrays){var wrap=document.getElementById(wrapId);var tip=document.getElementById(tipId);function move(evt){if(!lastRun)return;var arr=getArrays();var meta=drawFn.apply(null,[canvas].concat(arr).concat([null]));var pos=getCanvasMouse(canvas,evt);var N=meta.N;var i;if(N>0){if(meta.cols){var xRel=pos.x-meta.pL;var yRel=pos.y-meta.pT;var col=Math.floor((xRel-meta.gapX)/(meta.dotSize+meta.gapX));var row=Math.floor((yRel-meta.gapY)/(meta.dotSize+meta.gapY));i=row*meta.cols+col}else if(meta.barHeight){var xRel=pos.x-meta.pL;i=Math.floor((xRel/meta.inW)*N)}else{var xRel=pos.x-meta.pL;var colW=meta.cellW||meta.inW/Math.max(1,N);i=Math.floor(xRel/colW)}}else{i=0}if(i<0||i>=N){tip.style.display='none';drawFn.apply(null,[canvas].concat(arr).concat([null]));return}drawFn.apply(null,[canvas].concat(arr).concat([i]));var s=lastRun.scenarios[i];var html='<div class="hd">Trial '+(i+1)+'</div>'+'<div><span style="color:'+COLOR_SWITCH+'">Switch</span> '+(lastRun.sw.outcomes[i]?'WIN':'LOSS')+'</div>'+'<div><span style="color:'+COLOR_STAY+'">Stay</span> '+(lastRun.st.outcomes[i]?'WIN':'LOSS')+'</div>'+'<div class="small">car:'+s.car+' | first:'+s.first+' | opened:'+s.opened+'</div>';if(tipId==='tooltip1'){html='<div class="hd">Trial '+(i+1)+'</div>'+'<div><span style="color:'+COLOR_SWITCH+'">Switch</span>: '+formatPct(lastRun.sw.series[i]/100)+'</div>'+'<div><span style="color:'+COLOR_STAY+'">Stay</span>: '+formatPct(lastRun.st.series[i]/100)+'</div>'+'<div class="small">car:'+s.car+' | first:'+s.first+' | opened:'+s.opened+'</div>'}else if(tipId==='tooltip2'){var swWins=0,stWins=0;for(var j=0;j<=i;j++){if(lastRun.sw.outcomes[j])swWins++;if(lastRun.st.outcomes[j])stWins++}html='<div class="hd">Trial '+(i+1)+'</div>'+'<div><span style="color:'+COLOR_SWITCH+'">Switch</span> '+swWins+' wins ('+(lastRun.sw.outcomes[i]?'WIN':'LOSS')+')</div>'+'<div><span style="color:'+COLOR_STAY+'">Stay</span> '+stWins+' wins ('+(lastRun.st.outcomes[i]?'WIN':'LOSS')+')</div>'+'<div class="small">car:'+s.car+' | first:'+s.first+' | opened:'+s.opened+'</div>'}tip.innerHTML=html;var rect=wrap.getBoundingClientRect();var c=evt.touches?evt.touches[0]:evt;var isMobile=evt.touches&&evt.touches.length>0;var tx=c.clientX-rect.left+(isMobile?12:12);var ty=c.clientY-rect.top+(isMobile?-60:12);tip.style.display='block';tip.style.left=tx+'px';tip.style.top=ty+'px'}function leave(){if(!lastRun)return;var arr=getArrays();drawFn.apply(null,[canvas].concat(arr).concat([null]));tip.style.display='none'}canvas.addEventListener('mousemove',move,{passive:true});canvas.addEventListener('mouseleave',leave,{passive:true});canvas.addEventListener('touchstart',move,{passive:true});canvas.addEventListener('touchmove',move,{passive:true});canvas.addEventListener('touchend',leave,{passive:true})}
function start(){simulateAndRender();attachHover('wrap1',document.getElementById('chart1'),drawCumulative,'tooltip1',function(){return[lastRun.sw.series,lastRun.st.series]});attachHover('wrap2',document.getElementById('chart2'),drawRacingBars,'tooltip2',function(){return[lastRun.sw.outcomes,lastRun.st.outcomes]})}
document.getElementById('run').addEventListener('click',start);
window.addEventListener('load',start)
</script>
</body>
</html>
